{% extends "user_pages/base_user.html" %}

{% block user_content %}

<p class="m-0" style="font-size: 24px;">
  Username: {{ user.name }}
</p>

{% if current_user.is_authenticated and current_user.uid == user.uid|int %}
(<a id="open_modal" href>Edit my information</a>)<br>
{{ modal_form(edit_info_form, "Edit Your Information", "open_modal", user) }}
{% endif %}

<br>

<p>
  <b>Email</b><br>
  {{ user.email }}
</p>

{% if user.about %}
<p>
  <b>About</b><br>
  {{ user.about }}
</p>
{% endif %}

{% if designed_games|length > 0 %}
<p style="font-size: 24px;">Games designed by {{ user.name }}:</p>

<style>
  #card_container {
    display: flex;
    align-items: center;
    overflow-x: hidden;
    width: 38.5rem;
  }

  .designed_by:hover {
    text-decoration: underline;
  }

  .scroll_button {
    height: 50px;
    min-width: 40px;
    display: block;
    border-radius: 10px;
    font-size: 24px;
    font-weight: bold;
    outline: none;
    background-color: lightblue;
    border: none;
  }

  .scroll_button:focus {
    outline: none;
  }

  .card-link {
    text-decoration: none;
    color: black;
    margin: 0;
  }
</style>

<div id="designed_by_container" style="display: flex; align-items: center; gap: 10px;">

  {% if designed_games|length > 3 %}
  <button id="scroll_left" class="scroll_button" disabled>&lt;</button>
  {% endif %}

  <div id="card_container">
    {% for game in designed_games %}
    <a href="/games/{{ game.gid }}" class="card-link">
      <div class="card designed_by" style="min-width: 12rem; display: inline-block;">
        <img class="card-img-top" src="{{ game.thumbnail_url }}"
          style="height: 200px; object-fit: cover; object-position: top;" alt="Game Image">
        <div class="card-body">
          <p class="card-text" style="text-align: center;">{{ game.name }}</p>
        </div>
      </div>
    </a>
    {% endfor %}
  </div>

  {% if designed_games|length > 3 %}
  <button id="scroll_right" class="scroll_button">&gt;</button>
  {% endif %}
</div><br>

<script>
  let cards = document.querySelectorAll(".card-link");

  let card_index = 0;
  let max_index = Math.max(0, cards.length - 3); //because 3 cards visible

  function setDisabled() {
    document.getElementById("scroll_left").disabled = card_index == 0;
    document.getElementById("scroll_right").disabled = card_index == max_index;
  }

  document.getElementById("designed_by_container").addEventListener("click", function (e) {
    if (e.target.id == "scroll_left") {
      card_index = Math.max(0, card_index - 1);
      cards[card_index].scrollIntoView({ inline: "start", behavior: "smooth" });
    }

    if (e.target.id == "scroll_right") {
      card_index = Math.min(max_index, card_index + 1);
      cards[card_index].scrollIntoView({ inline: "start", behavior: "smooth" });
    }

    setDisabled();
  });
</script>

{% endif %}

{% endblock %}